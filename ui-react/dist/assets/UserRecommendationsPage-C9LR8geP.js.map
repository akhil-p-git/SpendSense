{"version":3,"file":"UserRecommendationsPage-C9LR8geP.js","sources":["../../src/components/recommendations/RecommendationCard.tsx","../../src/features/recommendations/RecommendationsView.tsx","../../src/pages/UserRecommendationsPage.tsx"],"sourcesContent":["/**\n * RecommendationCard Component\n * Displays a single recommendation with title, description, rationale, and CTA\n */\n\nimport React from 'react';\nimport type { Recommendation } from '@/types';\nimport { Card } from '@/components/common/Card';\nimport { Button } from '@/components/common/Button';\n\ninterface RecommendationCardProps {\n  recommendation: Recommendation;\n  onTrackClick?: (recommendationId: string, type: string) => void;\n  userId?: string;\n}\n\nexport const RecommendationCard: React.FC<RecommendationCardProps> = ({\n  recommendation,\n  onTrackClick,\n  userId,\n}) => {\n  const handleClick = () => {\n    if (onTrackClick && userId) {\n      const recommendationId = recommendation.id || recommendation.title;\n      onTrackClick(recommendationId, recommendation.type);\n    }\n    \n    if (recommendation.url) {\n      window.open(recommendation.url, '_blank', 'noopener,noreferrer');\n    }\n  };\n\n  const isEducation = recommendation.type === 'education';\n  const badgeColor = isEducation \n    ? 'bg-blue-100 text-blue-800 border-blue-300' \n    : 'bg-purple-100 text-purple-800 border-purple-300';\n  const badgeText = isEducation ? 'EDUCATION' : 'PARTNER OFFER';\n\n  return (\n    <Card className=\"hover:shadow-lg transition-shadow duration-200\">\n      <div className=\"flex flex-col\">\n        {/* Badge */}\n        <div className=\"flex items-center gap-2 mb-3\">\n          <span className={`px-2 py-1 text-xs font-semibold rounded border ${badgeColor}`}>\n            {badgeText}\n          </span>\n        </div>\n\n        {/* Title */}\n        <h4 className=\"text-lg font-semibold text-gray-900 mb-2\">\n          {recommendation.title}\n        </h4>\n\n        {/* Description */}\n        {recommendation.description && (\n          <p className=\"text-gray-600 mb-3 leading-relaxed\">\n            {recommendation.description}\n          </p>\n        )}\n\n        {/* Rationale */}\n        {recommendation.rationale && (\n          <div className=\"bg-gray-50 p-3 rounded-lg mb-4\">\n            <p className=\"text-sm text-gray-700\">\n              <strong className=\"text-gray-900\">Because:</strong>{' '}\n              {recommendation.rationale}\n            </p>\n          </div>\n        )}\n\n        {/* CTA Button */}\n        {recommendation.url && (\n          <div className=\"flex items-center justify-between mt-auto\">\n            <Button\n              variant=\"primary\"\n              size=\"sm\"\n              onClick={handleClick}\n              className=\"flex-1 sm:flex-none\"\n            >\n              Learn More\n            </Button>\n          </div>\n        )}\n\n        {/* Disclaimer */}\n        <div className=\"mt-4 pt-4 border-t border-gray-200\">\n          <p className=\"text-xs text-gray-500 italic\">\n            This is educational content, not financial advice.\n          </p>\n        </div>\n      </div>\n    </Card>\n  );\n};\n\n","/**\n * RecommendationsView Component\n * Displays personalized recommendations with education content and partner offers\n */\n\nimport React from 'react';\nimport { useRecommendations, useTrackRecommendationAcceptance } from '@/hooks/useApi';\nimport { useStore } from '@/store/useStore';\nimport { RecommendationCard } from '@/components/recommendations/RecommendationCard';\nimport { LoadingSpinner } from '@/components/common/LoadingSpinner';\nimport { ErrorMessage } from '@/components/common/ErrorMessage';\nimport { Card } from '@/components/common/Card';\n\nexport const RecommendationsView: React.FC = () => {\n  const { currentUserId } = useStore();\n  const { data: recommendations, isLoading, error } = useRecommendations(currentUserId);\n  const trackAcceptance = useTrackRecommendationAcceptance();\n\n  const handleTrackClick = (recommendationId: string, type: string) => {\n    if (currentUserId) {\n      trackAcceptance.mutate({\n        userId: currentUserId,\n        recommendationId,\n        type,\n      });\n    }\n  };\n\n  if (!currentUserId) {\n    return (\n      <div className=\"text-center text-gray-500 py-12\">\n        <Card>\n          <p className=\"text-lg\">Please select a user to view recommendations</p>\n        </Card>\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return (\n      <div className=\"flex justify-center items-center py-12\">\n        <div className=\"text-center\">\n          <LoadingSpinner size=\"lg\" />\n          <p className=\"mt-4 text-gray-600\">Loading recommendations...</p>\n        </div>\n      </div>\n    );\n  }\n\n  if (error) {\n    // Check if it's a consent error\n    const errorMessage = error instanceof Error ? error.message : 'Failed to load recommendations';\n    const isConsentError = errorMessage.toLowerCase().includes('consent') || \n                          errorMessage.toLowerCase().includes('403');\n\n    return (\n      <div className=\"py-6\">\n        <ErrorMessage message={errorMessage} />\n        {isConsentError && (\n          <Card className=\"mt-4 bg-yellow-50 border-yellow-200\">\n            <p className=\"text-sm text-yellow-800\">\n              <strong>Consent Required:</strong> This user has not provided consent for data processing. \n              Please update their consent status to view recommendations.\n            </p>\n          </Card>\n        )}\n      </div>\n    );\n  }\n\n  if (!recommendations) {\n    return (\n      <div className=\"text-center text-gray-500 py-12\">\n        <Card>\n          <p className=\"text-lg\">No recommendations available</p>\n        </Card>\n      </div>\n    );\n  }\n\n  const educationItems = recommendations.education || [];\n  const partnerOffers = recommendations.offers || [];\n\n  return (\n    <div className=\"space-y-8\">\n      {/* Disclaimer */}\n      {recommendations.disclaimer && (\n        <Card className=\"bg-blue-50 border-blue-200\">\n          <p className=\"text-sm text-blue-800\">\n            {recommendations.disclaimer}\n          </p>\n        </Card>\n      )}\n\n      {/* Education Content */}\n      {educationItems.length > 0 && (\n        <div>\n          <div className=\"flex items-center gap-3 mb-4\">\n            <h3 className=\"text-xl font-semibold text-gray-900\">Educational Content</h3>\n            <span className=\"px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full\">\n              {educationItems.length} {educationItems.length === 1 ? 'item' : 'items'}\n            </span>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {educationItems.map((rec, index) => (\n              <RecommendationCard\n                key={rec.id || `edu-${index}`}\n                recommendation={rec}\n                onTrackClick={handleTrackClick}\n                userId={currentUserId}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Partner Offers */}\n      {partnerOffers.length > 0 && (\n        <div>\n          <div className=\"flex items-center gap-3 mb-4\">\n            <h3 className=\"text-xl font-semibold text-gray-900\">Partner Offers</h3>\n            <span className=\"px-3 py-1 bg-purple-100 text-purple-800 text-sm font-medium rounded-full\">\n              {partnerOffers.length} {partnerOffers.length === 1 ? 'offer' : 'offers'}\n            </span>\n          </div>\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-6\">\n            {partnerOffers.map((rec, index) => (\n              <RecommendationCard\n                key={rec.id || `offer-${index}`}\n                recommendation={rec}\n                onTrackClick={handleTrackClick}\n                userId={currentUserId}\n              />\n            ))}\n          </div>\n        </div>\n      )}\n\n      {/* Empty State */}\n      {educationItems.length === 0 && partnerOffers.length === 0 && (\n        <Card>\n          <div className=\"text-center py-8\">\n            <p className=\"text-gray-600 mb-2\">No recommendations available at this time.</p>\n            <p className=\"text-sm text-gray-500\">\n              Recommendations are generated based on your financial profile and behavioral signals.\n            </p>\n          </div>\n        </Card>\n      )}\n    </div>\n  );\n};\n","/**\n * User Recommendations Page\n */\n\nimport React from 'react';\nimport { useParams, Navigate } from 'react-router-dom';\nimport { RecommendationsView } from '@/features/recommendations/RecommendationsView';\nimport { useStore } from '@/store/useStore';\n\nexport const UserRecommendationsPage: React.FC = () => {\n  const { userId } = useParams<{ userId: string }>();\n  const { setCurrentUserId } = useStore();\n\n  React.useEffect(() => {\n    if (userId) {\n      setCurrentUserId(userId);\n    }\n  }, [userId, setCurrentUserId]);\n\n  if (!userId) {\n    return <Navigate to=\"/\" replace />;\n  }\n\n  return (\n    <div>\n      <h2 className=\"text-2xl font-bold text-gray-900 mb-6\">Personalized Recommendations</h2>\n      <RecommendationsView />\n    </div>\n  );\n};\n\n"],"names":["RecommendationCard","recommendation","onTrackClick","userId","handleClick","recommendationId","isEducation","badgeColor","badgeText","Card","jsxs","jsx","Button","RecommendationsView","currentUserId","useStore","recommendations","isLoading","error","useRecommendations","trackAcceptance","useTrackRecommendationAcceptance","handleTrackClick","type","LoadingSpinner","errorMessage","isConsentError","ErrorMessage","educationItems","partnerOffers","rec","index","UserRecommendationsPage","useParams","setCurrentUserId","React","Navigate"],"mappings":"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"}
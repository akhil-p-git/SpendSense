import{j as e,r as h,u as P,d as L,e as I,C as N,E as C,L as A,f as D,R as $,B as R,g as W,c as q,N as V}from"./index-DWPGfbpl.js";import{f as u,a as Y}from"./format-i9BddnD9.js";const J=({tabs:a,activeTab:i,onTabChange:t})=>e.jsx("div",{className:"flex gap-2 mb-6 border-b-2 border-gray-200",children:a.map(l=>e.jsx("button",{onClick:()=>t(l.id),className:`
            px-6 py-3 font-medium text-sm transition-colors whitespace-nowrap
            border-b-3 -mb-0.5
            ${i===l.id?"text-primary-600 border-b-3 border-primary-600 font-semibold":"text-gray-600 border-b-3 border-transparent hover:text-primary-600 hover:border-primary-300"}
          `,children:l.label},l.id))});function O(a,i){const[t,l]=h.useState(a);return h.useEffect(()=>{const r=setTimeout(()=>{l(a)},i);return()=>{clearTimeout(r)}},[a,i]),t}const K=()=>{const{currentUserId:a}=P(),{data:i}=L(a),t=I(),[l,r]=h.useState(300),p=O(l,500),o=i==null?void 0:i.accounts.find(j=>j.type==="credit card"),n=o==null?void 0:o.account_id;if(h.useEffect(()=>{a&&n&&p>=0&&t.mutate({userId:a,scenario:{scenario_type:"extra_credit_payment",params:{account_id:n,extra_monthly_payment:p,months:12}}})},[a,n,p]),!a)return e.jsx(N,{children:e.jsx("p",{className:"text-gray-500",children:"Please select a user to run simulations."})});if(!n)return e.jsx(N,{children:e.jsx(C,{message:"No credit card account found for this user."})});const d=t.data,g=t.isPending,x=t.error;return e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Extra Debt Payment"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Extra Monthly Payment"}),e.jsx("span",{className:"text-lg font-semibold text-primary-600",children:u(l)})]}),e.jsx("input",{type:"range",min:"0",max:"1000",value:l,onChange:j=>r(parseInt(j.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary-600"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"$0"}),e.jsx("span",{children:"$1,000"})]})]}),g&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{size:"md"})}),x&&e.jsx(C,{message:x instanceof Error?x.message:"Failed to run simulation"}),d&&d.scenario_type==="extra_credit_payment"&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Balance"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:u(d.current_balance)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"APR"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:Y(d.apr)})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Projected Impact"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"New Payoff Date"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[d.extra_payment_scenario.months_to_payoff.toFixed(0)," months"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Interest Saved"}),e.jsx("span",{className:"font-semibold text-success-600",children:u(d.savings.interest_saved)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Months Saved"}),e.jsxs("span",{className:"font-semibold text-primary-600",children:[d.savings.months_saved.toFixed(0)," months"]})]})]})]}),d.recommendation&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800",children:d.recommendation})})]})]})},H=()=>{const{currentUserId:a}=P(),{data:i}=D(a),t=I(),l=$.useMemo(()=>{var y;if(!((y=i==null?void 0:i.signals)!=null&&y.subscriptions))return[];const c=i.signals.subscriptions.num_recurring_merchants||0;return[{name:"Netflix",amount:15.99},{name:"Spotify",amount:10.99},{name:"Adobe Creative",amount:22.99},{name:"Gym Membership",amount:45},{name:"Amazon Prime",amount:14.99},{name:"Disney+",amount:10.99}].slice(0,Math.max(c,6))},[i]),[r,p]=h.useState(new Set),o=h.useRef(""),n=h.useRef(null);h.useEffect(()=>{if(n.current&&(clearTimeout(n.current),n.current=null),!a||r.size===0||t.isPending){r.size===0&&(o.current="");return}const c=Array.from(r).sort().join(",");if(o.current!==c)return n.current=setTimeout(()=>{if(r.size===0||!a||t.isPending)return;const _=l.filter(y=>r.has(y.name)).map(y=>({name:y.name,amount:y.amount}));o.current=c,t.mutate({userId:a,scenario:{scenario_type:"subscription_cancellation",params:{subscriptions_to_cancel:_,months:12}}})},300),()=>{n.current&&clearTimeout(n.current)}},[a,r]);const d=c=>{p(_=>{const y=new Set(_);return y.has(c)?y.delete(c):y.add(c),y})};if(!a)return e.jsx(N,{children:e.jsx("p",{className:"text-gray-500",children:"Please select a user to run simulations."})});const g=t.data,x=t.isPending,j=t.error;return e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Subscription Cancellation"}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700 mb-3 block",children:"Select subscriptions to cancel:"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:l.map(c=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-gray-50 cursor-pointer border border-gray-200",children:[e.jsx("input",{type:"checkbox",checked:r.has(c.name),onChange:()=>d(c.name),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsxs("div",{className:"flex-1 flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c.name}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[u(c.amount),"/month"]})]})]},c.name))}),l.length===0&&e.jsx("p",{className:"text-sm text-gray-500 py-4",children:"No recurring subscriptions detected."})]}),r.size===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:e.jsx("p",{className:"text-sm",children:"Select subscriptions above to see projected savings."})}),x&&r.size>0&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{size:"md"})}),j&&r.size>0&&e.jsx(C,{message:j instanceof Error?j.message:"Failed to run simulation"}),g&&g.scenario_type==="subscription_cancellation"&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Projected Savings"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Monthly Savings"}),e.jsx("span",{className:"font-semibold text-success-600",children:u(g.monthly_savings)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Annual Savings"}),e.jsx("span",{className:"font-semibold text-success-600",children:u(g.annual_savings)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cash Flow Freed"}),e.jsxs("span",{className:"font-semibold text-primary-600",children:[g.percent_reduction.toFixed(1),"%"]})]})]})]}),g.alternative_uses&&g.alternative_uses.length>0&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Alternative uses:"}),e.jsx("ul",{className:"space-y-1",children:g.alternative_uses.map((c,_)=>e.jsxs("li",{className:"text-sm text-gray-600 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),e.jsx("span",{children:c})]},_))})]}),g.recommendation&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800",children:g.recommendation})})]})]})},Q=()=>{const{currentUserId:a}=P(),i=I(),[t,l]=h.useState(500),[r,p]=h.useState(""),o=O(t,500);if(h.useEffect(()=>{a&&o>=0&&i.mutate({userId:a,scenario:{scenario_type:"increased_savings",params:{monthly_amount:o,target_amount:r?parseFloat(r):null,months:12}}})},[a,o,r]),!a)return e.jsx(N,{children:e.jsx("p",{className:"text-gray-500",children:"Please select a user to run simulations."})});const n=i.data,d=i.isPending,g=i.error;return e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Increased Savings"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Monthly Savings Amount"}),e.jsx("span",{className:"text-lg font-semibold text-primary-600",children:u(t)})]}),e.jsx("input",{type:"range",min:"0",max:"2000",value:t,onChange:x=>l(parseInt(x.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary-600"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"$0"}),e.jsx("span",{children:"$2,000"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"target-amount",className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Amount (optional)"}),e.jsx("input",{type:"number",id:"target-amount",value:r,onChange:x=>p(x.target.value),placeholder:"e.g., 10000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),d&&e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(A,{size:"md"})}),g&&e.jsx(C,{message:g instanceof Error?g.message:"Failed to run simulation"}),n&&n.scenario_type==="increased_savings"&&e.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Current Savings"}),e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:u(n.current_state.savings_balance)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Monthly Contribution"}),e.jsx("div",{className:"text-lg font-semibold text-primary-600",children:u(n.monthly_contribution)})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Projected Growth (12 months)"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Final Balance"}),e.jsx("span",{className:"font-semibold text-success-600",children:u(n.projected_state.final_balance)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Your Contributions"}),e.jsx("span",{className:"font-semibold text-gray-900",children:u(n.projected_state.total_contributions)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Interest Earned"}),e.jsx("span",{className:"font-semibold text-success-600",children:u(n.projected_state.interest_earned)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Emergency Fund Coverage"}),e.jsxs("span",{className:"font-semibold text-primary-600",children:[n.projected_state.emergency_fund_months.toFixed(1)," months"]})]}),n.months_to_target&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Time to Reach Goal"}),e.jsxs("span",{className:"font-semibold text-primary-600",children:[n.months_to_target," months"]})]})]})]}),n.recommendation&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800",children:n.recommendation})})]})]})},X=()=>e.jsxs("div",{className:"space-y-8",children:[e.jsx(K,{}),e.jsx(H,{}),e.jsx(Q,{})]}),Z=()=>{const{currentUserId:a}=P(),{data:i}=L(a),t=I(),[l,r]=h.useState(12),[p,o]=h.useState(""),[n,d]=h.useState(!1),g=i==null?void 0:i.accounts.find(w=>w.type==="credit card"),x=g==null?void 0:g.account_id,j=()=>{!a||!x||(d(!0),t.mutate({userId:a,scenario:{scenario_type:"goal_based_payment",params:{account_id:x,target_months:l,max_monthly_payment:p?parseFloat(p):null}}},{onSettled:()=>d(!1)}))};if(!a)return e.jsx(N,{children:e.jsx("p",{className:"text-gray-500",children:"Please select a user to run simulations."})});if(!x)return e.jsx(N,{children:e.jsx(C,{message:"No credit card account found for this user."})});const c=t.data,_=t.isPending||n,y=t.error;return e.jsx("div",{className:"space-y-6",children:e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Goal-Based Debt Payoff"}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Target Months to Payoff"}),e.jsxs("span",{className:"text-lg font-semibold text-primary-600",children:[l," months"]})]}),e.jsx("input",{type:"range",min:"6",max:"60",value:l,onChange:w=>r(parseInt(w.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer accent-primary-600"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsx("span",{children:"6 months"}),e.jsx("span",{children:"60 months"})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{htmlFor:"max-payment",className:"block text-sm font-medium text-gray-700 mb-2",children:"Max Monthly Payment (optional)"}),e.jsx("input",{type:"number",id:"max-payment",value:p,onChange:w=>o(w.target.value),placeholder:"e.g., 1000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsx(R,{variant:"primary",onClick:j,disabled:_,className:"w-full sm:w-auto",children:_?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(A,{size:"sm"}),"Calculating..."]}):"Calculate Required Payment"}),y&&e.jsx("div",{className:"mt-4",children:e.jsx(C,{message:y instanceof Error?y.message:"Failed to calculate payment"})}),c&&c.scenario_type==="goal_based_payment"&&e.jsxs("div",{className:"mt-6 space-y-4 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Goal-Based Plan Results"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Required Monthly Payment"}),e.jsx("span",{className:"font-semibold text-primary-600",children:u(c.required_monthly_payment)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Current Minimum Payment"}),e.jsx("span",{className:"font-semibold text-gray-900",children:u(c.current_minimum_payment)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Payment Increase Needed"}),e.jsx("span",{className:"font-semibold text-warning-600",children:u(c.payment_increase)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Feasible with Goal?"}),e.jsx("span",{className:`font-semibold ${c.is_feasible?"text-success-600":"text-danger-600"}`,children:c.is_feasible?"Yes":"No"})]}),!c.is_feasible&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Actual Months with Max Payment"}),e.jsxs("span",{className:"font-semibold text-gray-900",children:[c.actual_months.toFixed(0)," months"]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Impact"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Interest Saved"}),e.jsx("span",{className:"font-semibold text-success-600",children:u(c.impact.interest_saved)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Months Saved"}),e.jsxs("span",{className:"font-semibold text-primary-600",children:[c.impact.months_saved.toFixed(0)," months"]})]})]})]}),c.recommendation&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800",children:c.recommendation})})]})]})})},ee=()=>{const{currentUserId:a}=P(),{data:i}=L(a),{data:t}=D(a),l=I(),[r,p]=h.useState(!1),[o,n]=h.useState(200),[d,g]=h.useState(!1),[x,j]=h.useState(new Set),[c,_]=h.useState(!1),[y,w]=h.useState(500),U=$.useMemo(()=>{var f;if(!((f=t==null?void 0:t.signals)!=null&&f.subscriptions))return[];const m=t.signals.subscriptions.num_recurring_merchants||0;return[{name:"Netflix",amount:15.99},{name:"Spotify",amount:10.99},{name:"Adobe Creative",amount:22.99},{name:"Gym Membership",amount:45},{name:"Amazon Prime",amount:14.99},{name:"Disney+",amount:10.99}].slice(0,Math.max(m,6))},[t]),E=i==null?void 0:i.accounts.find(m=>m.type==="credit card"),b=E==null?void 0:E.account_id,z=()=>{if(!a)return;const m=[];r&&b&&o>0&&m.push({type:"extra_credit_payment",account_id:b,amount:o}),d&&x.size>0&&m.push({type:"subscription_cancellation",subscriptions:U.filter(s=>x.has(s.name)).map(s=>({name:s.name,amount:s.amount}))}),c&&y>0&&m.push({type:"increased_savings",amount:y}),m.length!==0&&l.mutate({userId:a,scenario:{scenario_type:"combined",params:{scenarios:m,months:12}}})},T=m=>{j(s=>{const f=new Set(s);return f.has(m)?f.delete(m):f.add(m),f})};if(!a)return e.jsx(N,{children:e.jsx("p",{className:"text-gray-500",children:"Please select a user to run simulations."})});const v=l.data,F=l.isPending,k=l.error,M=r||d||c;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Combined Scenario Builder"}),e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:r,onChange:m=>p(m.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Extra Credit Payment"})]}),r&&e.jsxs("div",{className:"ml-7 mt-2",children:[e.jsx("input",{type:"number",value:o,onChange:m=>n(parseFloat(m.target.value)||0),placeholder:"200",min:"0",className:"w-full sm:w-48 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Monthly extra payment amount"})]})]}),e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:m=>g(m.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Cancel Subscriptions"})]}),d&&e.jsx("div",{className:"ml-7 mt-2",children:e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:U.map(m=>e.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:x.has(m.name),onChange:()=>T(m.name),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-900 flex-1",children:m.name}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[u(m.amount),"/month"]})]},m.name))})})]}),e.jsxs("div",{className:"mb-6 p-4 border border-gray-200 rounded-lg",children:[e.jsxs("label",{className:"flex items-center gap-3 mb-3 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:c,onChange:m=>_(m.target.checked),className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"font-medium text-gray-900",children:"Increase Savings"})]}),c&&e.jsxs("div",{className:"ml-7 mt-2",children:[e.jsx("input",{type:"number",value:y,onChange:m=>w(parseFloat(m.target.value)||0),placeholder:"500",min:"0",className:"w-full sm:w-48 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Monthly savings contribution"})]})]}),e.jsx(R,{variant:"primary",onClick:z,disabled:F||!M,className:"w-full sm:w-auto",children:F?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(A,{size:"sm"}),"Running..."]}):"Run Combined Scenario"}),!M&&e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please select at least one scenario to run."})]}),k&&e.jsx(N,{children:e.jsx(C,{message:k instanceof Error?k.message:"Failed to run combined scenario"})}),v&&v.scenario_type==="combined"&&e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Combined Scenario Impact"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Monthly Cash Flow Impact"}),e.jsx("div",{className:`text-2xl font-bold ${v.monthly_cash_flow_impact>=0?"text-success-600":"text-danger-600"}`,children:u(v.monthly_cash_flow_impact)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Annual Cash Flow Impact"}),e.jsx("div",{className:`text-2xl font-bold ${v.annual_cash_flow_impact>=0?"text-success-600":"text-danger-600"}`,children:u(v.annual_cash_flow_impact)})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Interest Saved"}),e.jsx("div",{className:"text-xl font-semibold text-success-600",children:u(v.total_interest_saved)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Subscription Savings"}),e.jsx("div",{className:"text-xl font-semibold text-purple-600",children:u(v.total_subscription_savings)})]})]}),v.summary&&v.summary.length>0&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Summary"}),e.jsx("ul",{className:"space-y-1",children:v.summary.map((m,s)=>e.jsxs("li",{className:"text-sm text-gray-700 flex items-start",children:[e.jsx("span",{className:"mr-2",children:"•"}),e.jsx("span",{children:m})]},s))})]}),v.recommendation&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 p-3 rounded-lg",children:e.jsx("p",{className:"text-sm text-blue-800",children:v.recommendation})})]})]})]})},se=()=>{var F,k,M,m;const{currentUserId:a}=P(),{data:i}=L(a),{data:t}=D(a),l=I(),[r,p]=h.useState(""),[o,n]=h.useState({type:""}),[d,g]=h.useState(""),[x,j]=h.useState({type:""}),c=i==null?void 0:i.accounts.find(s=>s.type==="credit card"),_=c==null?void 0:c.account_id,y=$.useMemo(()=>{var S;if(!((S=t==null?void 0:t.signals)!=null&&S.subscriptions))return[];const s=t.signals.subscriptions.num_recurring_merchants||0;return[{name:"Netflix",amount:15.99},{name:"Spotify",amount:10.99},{name:"Adobe Creative",amount:22.99},{name:"Gym Membership",amount:45},{name:"Amazon Prime",amount:14.99},{name:"Disney+",amount:10.99}].slice(0,Math.max(s,6))},[t]),w=s=>{p(s),n(s==="extra_credit_payment"?{type:s,amount:200}:s==="subscription_cancellation"?{type:s,subscriptions:[]}:s==="increased_savings"?{type:s,amount:500}:{type:""})},U=s=>{g(s),j(s==="extra_credit_payment"?{type:s,amount:200}:s==="subscription_cancellation"?{type:s,subscriptions:[]}:s==="increased_savings"?{type:s,amount:500}:{type:""})},E=()=>{if(!a||!r||!d)return;const s={type:r};r==="extra_credit_payment"?(s.account_id=_,s.amount=o.amount||200):r==="subscription_cancellation"?s.subscriptions=o.subscriptions||[]:r==="increased_savings"&&(s.amount=o.amount||500,s.target_amount=o.target_amount||null);const f={type:d};d==="extra_credit_payment"?(f.account_id=_,f.amount=x.amount||200):d==="subscription_cancellation"?f.subscriptions=x.subscriptions||[]:d==="increased_savings"&&(f.amount=x.amount||500,f.target_amount=x.target_amount||null),l.mutate({userId:a,scenario:{scenario_type:"compare",params:{scenario_a:s,scenario_b:f}}})};if(!a)return e.jsx(N,{children:e.jsx("p",{className:"text-gray-500",children:"Please select a user to run simulations."})});const b=l.data,z=l.isPending,T=l.error,v=r&&d;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Compare Two Scenarios"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Scenario A"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scenario Type"}),e.jsxs("select",{value:r,onChange:s=>w(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select scenario type..."}),e.jsx("option",{value:"extra_credit_payment",children:"Extra Credit Payment"}),e.jsx("option",{value:"subscription_cancellation",children:"Cancel Subscriptions"}),e.jsx("option",{value:"increased_savings",children:"Increase Savings"})]})]}),r==="extra_credit_payment"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Extra Payment Amount"}),e.jsx("input",{type:"number",value:o.amount||200,onChange:s=>n({...o,amount:parseFloat(s.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),r==="subscription_cancellation"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Subscriptions"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:y.map(s=>{var f;return e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((f=o.subscriptions)==null?void 0:f.some(S=>S.name===s.name))||!1,onChange:S=>{const B=o.subscriptions||[];S.target.checked?n({...o,subscriptions:[...B,{name:s.name,amount:s.amount}]}):n({...o,subscriptions:B.filter(G=>G.name!==s.name)})},className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-900 flex-1",children:s.name}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[u(s.amount),"/month"]})]},s.name)})})]}),r==="increased_savings"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Savings Amount"}),e.jsx("input",{type:"number",value:o.amount||500,onChange:s=>n({...o,amount:parseFloat(s.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Amount (optional)"}),e.jsx("input",{type:"number",value:o.target_amount||"",onChange:s=>n({...o,target_amount:parseFloat(s.target.value)||void 0}),placeholder:"e.g., 10000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:"Scenario B"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Scenario Type"}),e.jsxs("select",{value:d,onChange:s=>U(s.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select scenario type..."}),e.jsx("option",{value:"extra_credit_payment",children:"Extra Credit Payment"}),e.jsx("option",{value:"subscription_cancellation",children:"Cancel Subscriptions"}),e.jsx("option",{value:"increased_savings",children:"Increase Savings"})]})]}),d==="extra_credit_payment"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Extra Payment Amount"}),e.jsx("input",{type:"number",value:x.amount||200,onChange:s=>j({...x,amount:parseFloat(s.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),d==="subscription_cancellation"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Subscriptions"}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border border-gray-200 rounded-lg p-2",children:y.map(s=>{var f;return e.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-gray-50 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:((f=x.subscriptions)==null?void 0:f.some(S=>S.name===s.name))||!1,onChange:S=>{const B=x.subscriptions||[];S.target.checked?j({...x,subscriptions:[...B,{name:s.name,amount:s.amount}]}):j({...x,subscriptions:B.filter(G=>G.name!==s.name)})},className:"w-4 h-4 text-primary-600 border-gray-300 rounded focus:ring-primary-500"}),e.jsx("span",{className:"text-sm text-gray-900 flex-1",children:s.name}),e.jsxs("span",{className:"text-sm font-semibold text-gray-700",children:[u(s.amount),"/month"]})]},s.name)})})]}),d==="increased_savings"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Monthly Savings Amount"}),e.jsx("input",{type:"number",value:x.amount||500,onChange:s=>j({...x,amount:parseFloat(s.target.value)||0}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Amount (optional)"}),e.jsx("input",{type:"number",value:x.target_amount||"",onChange:s=>j({...x,target_amount:parseFloat(s.target.value)||void 0}),placeholder:"e.g., 10000",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx(R,{variant:"primary",onClick:E,disabled:z||!v,className:"w-full sm:w-auto",children:z?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(A,{size:"sm"}),"Comparing..."]}):"Compare Scenarios"}),!v&&e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Please select both scenarios to compare."})]})]}),T&&e.jsx(N,{children:e.jsx(C,{message:T instanceof Error?T.message:"Failed to compare scenarios"})}),b&&b.scenario_type==="compare"&&e.jsxs(N,{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Scenario Comparison"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Scenario A: ",b.scenario_a.scenario_type.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase())]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[b.scenario_a.scenario_type==="extra_credit_payment"&&e.jsxs("span",{children:["Extra payment: ",u(((F=b.scenario_a.extra_payment_scenario)==null?void 0:F.monthly_payment)||0)]}),b.scenario_a.scenario_type==="subscription_cancellation"&&e.jsxs("span",{children:["Monthly savings: ",u(b.scenario_a.monthly_savings||0)]}),b.scenario_a.scenario_type==="increased_savings"&&e.jsxs("span",{children:["Final balance: ",u(((k=b.scenario_a.projected_state)==null?void 0:k.final_balance)||0)]})]})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 mb-2",children:["Scenario B: ",b.scenario_b.scenario_type.replace("_"," ").replace(/\b\w/g,s=>s.toUpperCase())]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[b.scenario_b.scenario_type==="extra_credit_payment"&&e.jsxs("span",{children:["Extra payment: ",u(((M=b.scenario_b.extra_payment_scenario)==null?void 0:M.monthly_payment)||0)]}),b.scenario_b.scenario_type==="subscription_cancellation"&&e.jsxs("span",{children:["Monthly savings: ",u(b.scenario_b.monthly_savings||0)]}),b.scenario_b.scenario_type==="increased_savings"&&e.jsxs("span",{children:["Final balance: ",u(((m=b.scenario_b.projected_state)==null?void 0:m.final_balance)||0)]})]})]})]}),b.comparison_metrics&&e.jsxs("div",{className:"bg-blue-50 border border-blue-200 p-4 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"Comparison Metrics"}),b.comparison_metrics.better_scenario&&e.jsxs("div",{className:"mb-3",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Better Scenario: "}),e.jsxs("span",{className:"font-semibold text-primary-600",children:["Scenario ",b.comparison_metrics.better_scenario.toUpperCase()]})]}),b.comparison_metrics.recommendation&&e.jsx("p",{className:"text-sm text-blue-800",children:b.comparison_metrics.recommendation})]})]})]})]})},ae=({scenarioResult:a})=>{const{currentUserId:i}=P(),t=W(),l=async r=>{if(!(!a||!i||t.isPending))try{const p=await t.mutateAsync({userId:i,scenarioResult:a,format:r}),o=window.URL.createObjectURL(p),n=document.createElement("a");n.href=o,n.download=`scenario_report_${new Date().toISOString().split("T")[0]}.${r}`,document.body.appendChild(n),n.click(),window.URL.revokeObjectURL(o),document.body.removeChild(n)}catch(p){p!=null&&p.__handled||(console.error("Export failed:",p),p.__handled=!0),alert(`Failed to export ${r.toUpperCase()}: ${p instanceof Error?p.message:"Unknown error"}`)}};return a?e.jsxs("div",{className:"flex gap-3 justify-end mt-6",children:[e.jsx(R,{variant:"secondary",onClick:()=>l("json"),disabled:t.isPending,children:t.isPending?"Exporting...":"Export as JSON"}),e.jsx(R,{variant:"secondary",onClick:()=>l("pdf"),disabled:t.isPending,children:t.isPending?"Exporting...":"Export as PDF"})]}):null},te=()=>{const[a,i]=h.useState("basic"),t=I(),l=[{id:"basic",label:"Basic Scenarios"},{id:"goal",label:"Goal-Based Planning"},{id:"combined",label:"Combined Scenarios"},{id:"compare",label:"Compare Scenarios"}],r=t.data;return e.jsxs("div",{className:"space-y-6",children:[e.jsx(J,{tabs:l,activeTab:a,onTabChange:i}),e.jsxs("div",{className:"mt-6",children:[a==="basic"&&e.jsx(X,{}),a==="goal"&&e.jsx(Z,{}),a==="combined"&&e.jsx(ee,{}),a==="compare"&&e.jsx(se,{})]}),e.jsx(ae,{scenarioResult:r||null})]})},ie=()=>{const{userId:a}=q(),{setCurrentUserId:i}=P();return $.useEffect(()=>{a&&i(a)},[a,i]),a?e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"What-If Scenario Simulator"}),e.jsx(te,{})]}):e.jsx(V,{to:"/",replace:!0})};export{ie as UserWhatIfPage};
//# sourceMappingURL=UserWhatIfPage-DwgHCYiX.js.map
